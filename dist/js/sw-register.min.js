document.addEventListener("DOMContentLoaded",()=>{"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(e=>Promise.all(e.map(e=>e.unregister()))).finally(()=>{navigator.serviceWorker.register("/service-worker.min.js").then(()=>{window.cleanApiCache=()=>navigator.serviceWorker.controller?.postMessage({type:"clean"})}).catch(e=>console.error("SW registration failed",e))})});
